<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Penground API Encryption/Decryption</title>
    <style>
        .output {
            word-wrap: break-word;
        }

        .copied-text {
            display: none;
            margin-left: 10px;
            color: green;
        }
    </style>
    <script>
        // Encrypt function
        async function encryptMessage() {
            const payload = document.getElementById('encryptInput').value;
            const algorithm = document.getElementById('encryptAlgorithm').value;

            const url = '/api/v1/cryptography/encrypt';
            const requestBody = {
                payload: payload,
                algorithm: algorithm
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });

                if (response.ok) {
                    const data = await response.json();
                    const encryptedOutput = data.payload;

                    // Display truncated output if it exceeds 50 characters
                    document.getElementById('encryptedOutput').setAttribute('data-full-output', encryptedOutput);
                    if (encryptedOutput.length > 50) {
                        const truncatedOutput = encryptedOutput.substring(0, 50) + '... (Truncated)';
                        document.getElementById('encryptedOutput').innerText = truncatedOutput;
                    } else {
                        document.getElementById('encryptedOutput').innerText = encryptedOutput;
                    }
                } else {
                    const error = await response.json();
                    console.error('Encryption Error:', error.message);
                }
            } catch (error) {
                console.error('Request Error:', error);
            }
        }

        // Decrypt function
        async function decryptMessage() {
            const payload = document.getElementById('decryptInput').value;
            const algorithm = document.getElementById('decryptAlgorithm').value;

            const url = '/api/v1/cryptography/decrypt';
            const requestBody = {
                payload: payload,
                algorithm: algorithm
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });

                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('decryptedOutput').innerText = data.payload;
                } else {
                    const error = await response.json();
                    console.error('Decryption Error:', error.message);
                }
            } catch (error) {
                console.error('Request Error:', error);
            }
        }

        // Copy text function
        function copyText(outputId) {
            const outputElement = document.getElementById(outputId);
            const text = outputElement.innerText;

            navigator.clipboard.writeText(text)
                .then(() => {
                    const copiedText = document.getElementById(outputId + '-copied');
                    copiedText.style.display = 'inline';
                    setTimeout(() => {
                        copiedText.style.display = 'none';
                    }, 2000);
                })
                .catch((error) => {
                    console.error('Copy Error:', error);
                });
        }

        // Pass to Decrypt function
        function passToDecrypt() {
            const encryptedOutput = document.getElementById('encryptedOutput').getAttribute('data-full-output');
            const selectedAlgorithm = document.getElementById('encryptAlgorithm').value;

            // Set values in the decrypt UI
            document.getElementById('decryptInput').value = encryptedOutput;
            document.getElementById('decryptAlgorithm').value = selectedAlgorithm;

            // Trigger decryption
            decryptMessage();
        }
    </script>
</head>
<body>
<h1>Message Encryption</h1>
<form onsubmit="event.preventDefault(); encryptMessage();">
    <label for="encryptInput">Encrypt Message:</label>
    <input type="text" id="encryptInput" required>
    <label for="encryptAlgorithm">Algorithm:</label>
    <select id="encryptAlgorithm" required>
        <option value="LKH">LKH</option>
        <option value="SYS">SYS</option>
    </select>
    <button type="submit">Encrypt</button>
</form>
<p><strong>Encrypted Output:</strong></p>
<div class="output">
    <span id="encryptedOutput"></span>
</div>
<button onclick="copyText('encryptedOutput')">Copy Output</button>
<span id="encryptedOutput-copied" class="copied-text">Copied</span>
<button onclick="passToDecrypt()">Pass to Decrypt</button>

<h1>Message Decryption</h1>
<form onsubmit="event.preventDefault(); decryptMessage();">
    <label for="decryptInput">Decrypt Message:</label>
    <input type="text" id="decryptInput" required>
    <label for="decryptAlgorithm">Algorithm:</label>
    <select id="decryptAlgorithm" required>
        <option value="LKH">LKH</option>
        <option value="SYS">SYS</option>
    </select>
    <button type="submit">Decrypt</button>
</form>
<p><strong>Decrypted Output:</strong></p>
<div class="output">
    <span id="decryptedOutput"></span>
</div>
<button onclick="copyText('decryptedOutput')">Copy Output</button>
<span id="decryptedOutput-copied" class="copied-text">Copied</span>

</body>
</html>